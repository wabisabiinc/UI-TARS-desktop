name: Release UI-TARS app

on:
  push:
    branches:
      - main

jobs:
  publish_windows:
    runs-on: windows-latest
    steps:
      # 1) ã‚½ãƒ¼ã‚¹ã‚’ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆ
      - uses: actions/checkout@v4

      # 2) pnpm ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ä¾å­˜è§£æ±º
      - name: Install pnpm and dependencies
        run: |
          npm install -g pnpm@9
          pnpm install

      # 3) Windows å‘ã‘ãƒ“ãƒ«ãƒ‰ï¼†GitHub Releases ã¸ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
      - name: Build & Publish Windows
        shell: bash
        env:
          GITHUB_TOKEN: ${{ secrets.GH_TOKEN }}   # â† ã“ã“é‡è¦
        run: |
          cd apps/ui-tars
          pnpm run publish:win32

      # 4) Render ã«è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’ãƒˆãƒªã‚¬ãƒ¼
      - name: Trigger deploy on Render
        run: |
          echo "ğŸŒ Triggering Render deploy via webhook"
          curl -X POST "${{ secrets.RENDER_DEPLOY_HOOK_URL }}" \
            -H "Content-Type: application/json"
