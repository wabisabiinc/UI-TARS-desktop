# Dockerfile.ui
FROM node:20.13.1-alpine

WORKDIR /app

# pnpm をグローバルインストール
RUN npm install -g pnpm@9.12.3

# 1) アプリの package.json（依存一覧）だけコピー
COPY apps/agent-tars/package.json ./

# 2) CI で生成されたビルド成果物を丸ごとコピー
COPY apps/agent-tars/dist ./dist

# 3) production 依存だけインストール
RUN pnpm install --prod

# 4) アプリを起動
WORKDIR /app
CMD ["pnpm", "run", "start:web"]
