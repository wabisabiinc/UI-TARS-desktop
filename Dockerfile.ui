# Dockerfile.ui
FROM node:20.13.1-alpine

WORKDIR /app

# pnpm をグローバルインストール
RUN npm install -g pnpm@9.12.3

# 1) アプリの package.json（依存一覧）だけコピー
COPY apps/agent-tars/package.json ./

# 2) CI が生成したビルド成果物を丸ごとコピー
COPY apps/agent-tars/dist ./dist

# 3) production 依存だけインストール
#    workspace:* 依存を含むなら、
#    必要なローカルパッケージがあれば
#    事前に CI でビルド＆パッケージ化してください
RUN pnpm install --prod

# 4) 起動コマンド
CMD ["pnpm", "run", "start:web"]
